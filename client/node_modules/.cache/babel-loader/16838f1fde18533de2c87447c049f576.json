{"remainingRequest":"C:\\Users\\Lily\\Documents\\Cours\\MASTER 1\\WEB\\TP 3\\tp3\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\Lily\\Documents\\Cours\\MASTER 1\\WEB\\TP 3\\tp3\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\Lily\\Documents\\Cours\\MASTER 1\\WEB\\TP 3\\tp3\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Lily\\Documents\\Cours\\MASTER 1\\WEB\\TP 1\\restaurants\\src\\components\\HelloWorld.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\Lily\\Documents\\Cours\\MASTER 1\\WEB\\TP 1\\restaurants\\src\\components\\HelloWorld.vue","mtime":1631780577144},{"path":"C:\\Users\\Lily\\Documents\\Cours\\MASTER 1\\WEB\\TP 3\\tp3\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Lily\\Documents\\Cours\\MASTER 1\\WEB\\TP 3\\tp3\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\Users\\Lily\\Documents\\Cours\\MASTER 1\\WEB\\TP 3\\tp3\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Lily\\Documents\\Cours\\MASTER 1\\WEB\\TP 3\\tp3\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIkM6L1VzZXJzL0xpbHkvRG9jdW1lbnRzL0NvdXJzL01BU1RFUiAxL1dFQi9UUCAzL3RwMy9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vYXN5bmNUb0dlbmVyYXRvciI7CmltcG9ydCAicmVnZW5lcmF0b3ItcnVudGltZS9ydW50aW1lLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5mb3ItZWFjaC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZpbmQtaW5kZXguanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5zcGxpY2UuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5mdW5jdGlvbi5uYW1lLmpzIjsKLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KaW1wb3J0IF8gZnJvbSAibG9kYXNoIjsKaW1wb3J0IHsgY29sbGVjdGlvbiwgYWRkRG9jLCBkb2MsIGRlbGV0ZURvYywgb25TbmFwc2hvdCB9IGZyb20gImZpcmViYXNlL2ZpcmVzdG9yZSI7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiSGVsbG9Xb3JsZCIsCiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIG5hbWU6ICIiLAogICAgICBhbW91bnQ6ICIiLAogICAgICB0b3RhbDogMCwKICAgICAgcmVzdGF1cmFudHM6IFtdCiAgICB9OwogIH0sCiAgY3JlYXRlZDogZnVuY3Rpb24gY3JlYXRlZCgpIHsKICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgb25TbmFwc2hvdChjb2xsZWN0aW9uKHRoaXMuJGRiLCAicmVzdGF1cmFudHMiKSwgZnVuY3Rpb24gKHNuYXBzaG90KSB7CiAgICAgIHNuYXBzaG90LmRvY0NoYW5nZXMoKS5mb3JFYWNoKGZ1bmN0aW9uIChjaGFuZ2UpIHsKICAgICAgICBjb25zb2xlLmRpcihjaGFuZ2UudHlwZSk7CiAgICAgICAgY29uc29sZS5kaXIoY2hhbmdlLmRvYy5pZCk7CiAgICAgICAgY29uc29sZS5kaXIoY2hhbmdlLmRvYy5kYXRhKCkpOwogICAgICAgIHZhciByID0gY2hhbmdlLmRvYy5kYXRhKCk7CiAgICAgICAgdmFyIGlkID0gY2hhbmdlLmRvYy5pZDsKICAgICAgICB2YXIgcG9zOwoKICAgICAgICBzd2l0Y2ggKGNoYW5nZS50eXBlKSB7CiAgICAgICAgICBjYXNlICJhZGRlZCI6CiAgICAgICAgICAgIHIuaWQgPSBpZDsKCiAgICAgICAgICAgIF90aGlzLnJlc3RhdXJhbnRzLnB1c2gocik7CgogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlICJtb2RpZmllZCI6CiAgICAgICAgICAgIHBvcyA9IF90aGlzLnJlc3RhdXJhbnRzLmZpbmRJbmRleChmdW5jdGlvbiAoZWxlbWVudCkgewogICAgICAgICAgICAgIHJldHVybiBlbGVtZW50LmlkID09PSBpZDsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCJQT1MgPSAiICsgcG9zICsgIiBpZD0iICsgaWQpOyAvL2NvbnNvbGUuZGlyKHRoaXMucmVzdGF1cmFudHMpOwoKICAgICAgICAgICAgci5pZCA9IGlkOwoKICAgICAgICAgICAgX3RoaXMuJHNldChfdGhpcy5yZXN0YXVyYW50cywgcG9zLCByKTsgLy8gdGhpcy5yZXN0YXVyYW50c1twb3NdID0gcjsgLy8gbWFyY2hlIHBhcywgbGEgdnVlIG5lIHNlIG1ldCBwYXMgw6Agam91ciwgaWwgZmF1dCAkc2V0ICEhCgoKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAicmVtb3ZlZCI6CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCJyZW1vdmVkIik7CiAgICAgICAgICAgIHBvcyA9IF90aGlzLnJlc3RhdXJhbnRzLmZpbmRJbmRleChmdW5jdGlvbiAoZWxlbWVudCkgewogICAgICAgICAgICAgIHJldHVybiBlbGVtZW50LmlkID09PSBpZDsKICAgICAgICAgICAgfSk7CgogICAgICAgICAgICBfdGhpcy5yZXN0YXVyYW50cy5zcGxpY2UocG9zLCAxKTsKCiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9KTsKICB9LAogIG1ldGhvZHM6IHsKICAgIGFkZFJlc3RhdXJhbnQ6IGZ1bmN0aW9uIGFkZFJlc3RhdXJhbnQoKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZSgpIHsKICAgICAgICB2YXIgZG9jUmVmOwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIF9jb250ZXh0LnByZXYgPSAwOwogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDM7CiAgICAgICAgICAgICAgICByZXR1cm4gYWRkRG9jKGNvbGxlY3Rpb24oX3RoaXMyLiRkYiwgInJlc3RhdXJhbnRzIiksIHsKICAgICAgICAgICAgICAgICAgbmFtZTogX3RoaXMyLm5hbWUsCiAgICAgICAgICAgICAgICAgIGN1aXNpbmU6IF90aGlzMi5jdWlzaW5lLAogICAgICAgICAgICAgICAgICBkYXRlQ3JlYXRlZDogbmV3IERhdGUoKQogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICAgIGRvY1JlZiA9IF9jb250ZXh0LnNlbnQ7CiAgICAgICAgICAgICAgICBfdGhpczIuY3Vpc2luZSA9ICIiOwogICAgICAgICAgICAgICAgX3RoaXMyLm5hbWUgPSAiIjsKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJEb2N1bWVudCB3cml0dGVuIHdpdGggSUQ6ICIsIGRvY1JlZi5pZCk7CiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTI7CiAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgY2FzZSA5OgogICAgICAgICAgICAgICAgX2NvbnRleHQucHJldiA9IDk7CiAgICAgICAgICAgICAgICBfY29udGV4dC50MCA9IF9jb250ZXh0WyJjYXRjaCJdKDApOwogICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcigiRXJyb3IgYWRkaW5nIGRvY3VtZW50OiAiLCBfY29udGV4dC50MCk7CgogICAgICAgICAgICAgIGNhc2UgMTI6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlLCBudWxsLCBbWzAsIDldXSk7CiAgICAgIH0pKSgpOwogICAgfSwKICAgIHJlbW92ZVJlc3RhdXJhbnQ6IGZ1bmN0aW9uIHJlbW92ZVJlc3RhdXJhbnQocmVzdGF1cmFudCkgewogICAgICB2YXIgX3RoaXMzID0gdGhpczsKCiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUyKCkgewogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMiQoX2NvbnRleHQyKSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Mi5wcmV2ID0gX2NvbnRleHQyLm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDI7CiAgICAgICAgICAgICAgICByZXR1cm4gZGVsZXRlRG9jKGRvYyhfdGhpczMuJGRiLCAicmVzdGF1cmFudHMiLCByZXN0YXVyYW50LmlkKSk7CgogICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdqZSBzdXBwcmltZSBkb2MgaWQgPSAnICsgcmVzdGF1cmFudC5pZCk7CgogICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlMik7CiAgICAgIH0pKSgpOwogICAgfQogIH0sCiAgd2F0Y2g6IHsKICAgIHJlc3RhdXJhbnRzOiBmdW5jdGlvbiByZXN0YXVyYW50cygpIHsKICAgICAgdGhpcy50b3RhbCA9IF8uc3VtQnkodGhpcy5yZXN0YXVyYW50cywgZnVuY3Rpb24gKHJlc3RhdXJhbnQpIHsKICAgICAgICByZXR1cm4gcGFyc2VGbG9hdChyZXN0YXVyYW50LmFtb3VudCk7CiAgICAgIH0pOwogICAgfQogIH0KfTs="},{"version":3,"sources":["HelloWorld.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiCA,OAAA,CAAA,MAAA,QAAA;AAEA,SAAA,UAAA,EAAA,MAAA,EAAA,GAAA,EAAA,SAAA,EAAA,UAAA,QAAA,oBAAA;AAEA,eAAA;AACA,EAAA,IAAA,EAAA,YADA;AAEA,EAAA,IAAA,EAAA;AAAA,WAAA;AACA,MAAA,IAAA,EAAA,EADA;AAEA,MAAA,MAAA,EAAA,EAFA;AAGA,MAAA,KAAA,EAAA,CAHA;AAIA,MAAA,WAAA,EAAA;AAJA,KAAA;AAAA,GAFA;AAQA,EAAA,OARA,qBAQA;AAAA;;AACA,IAAA,UAAA,CAAA,UAAA,CAAA,KAAA,GAAA,EAAA,aAAA,CAAA,EAAA,UAAA,QAAA,EAAA;AACA,MAAA,QAAA,CAAA,UAAA,GAAA,OAAA,CAAA,UAAA,MAAA,EAAA;AACA,QAAA,OAAA,CAAA,GAAA,CAAA,MAAA,CAAA,IAAA;AACA,QAAA,OAAA,CAAA,GAAA,CAAA,MAAA,CAAA,GAAA,CAAA,EAAA;AACA,QAAA,OAAA,CAAA,GAAA,CAAA,MAAA,CAAA,GAAA,CAAA,IAAA,EAAA;AAEA,YAAA,CAAA,GAAA,MAAA,CAAA,GAAA,CAAA,IAAA,EAAA;AACA,YAAA,EAAA,GAAA,MAAA,CAAA,GAAA,CAAA,EAAA;AACA,YAAA,GAAA;;AAEA,gBAAA,MAAA,CAAA,IAAA;AACA,eAAA,OAAA;AACA,YAAA,CAAA,CAAA,EAAA,GAAA,EAAA;;AACA,YAAA,KAAA,CAAA,WAAA,CAAA,IAAA,CAAA,CAAA;;AACA;;AACA,eAAA,UAAA;AACA,YAAA,GAAA,GAAA,KAAA,CAAA,WAAA,CAAA,SAAA,CAAA,UAAA,OAAA;AAAA,qBAAA,OAAA,CAAA,EAAA,KAAA,EAAA;AAAA,aAAA,CAAA;AACA,YAAA,OAAA,CAAA,GAAA,CAAA,WAAA,GAAA,GAAA,MAAA,GAAA,EAAA,EAFA,CAGA;;AACA,YAAA,CAAA,CAAA,EAAA,GAAA,EAAA;;AACA,YAAA,KAAA,CAAA,IAAA,CAAA,KAAA,CAAA,WAAA,EAAA,GAAA,EAAA,CAAA,EALA,CAMA;;;AACA;;AACA,eAAA,SAAA;AACA,YAAA,OAAA,CAAA,GAAA,CAAA,SAAA;AACA,YAAA,GAAA,GAAA,KAAA,CAAA,WAAA,CAAA,SAAA,CAAA,UAAA,OAAA;AAAA,qBAAA,OAAA,CAAA,EAAA,KAAA,EAAA;AAAA,aAAA,CAAA;;AACA,YAAA,KAAA,CAAA,WAAA,CAAA,MAAA,CAAA,GAAA,EAAA,CAAA;;AACA;AAjBA;AAmBA,OA5BA;AA6BA,KA9BA,CAAA;AA+BA,GAxCA;AAyCA,EAAA,OAAA,EAAA;AACA,IAAA,aADA,2BACA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBAEA,MAAA,CAAA,UAAA,CAAA,MAAA,CAAA,GAAA,EAAA,aAAA,CAAA,EAAA;AACA,kBAAA,IAAA,EAAA,MAAA,CAAA,IADA;AAEA,kBAAA,OAAA,EAAA,MAAA,CAAA,OAFA;AAGA,kBAAA,WAAA,EAAA,IAAA,IAAA;AAHA,iBAAA,CAFA;;AAAA;AAEA,gBAAA,MAFA;AAOA,gBAAA,MAAA,CAAA,OAAA,GAAA,EAAA;AACA,gBAAA,MAAA,CAAA,IAAA,GAAA,EAAA;AAEA,gBAAA,OAAA,CAAA,GAAA,CAAA,4BAAA,EAAA,MAAA,CAAA,EAAA;AAVA;AAAA;;AAAA;AAAA;AAAA;AAYA,gBAAA,OAAA,CAAA,KAAA,CAAA,yBAAA;;AAZA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAcA,KAfA;AAgBA,IAAA,gBAhBA,4BAgBA,UAhBA,EAgBA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBACA,SAAA,CAAA,GAAA,CAAA,MAAA,CAAA,GAAA,EAAA,aAAA,EAAA,UAAA,CAAA,EAAA,CAAA,CADA;;AAAA;AAEA,gBAAA,OAAA,CAAA,GAAA,CAAA,0BAAA,UAAA,CAAA,EAAA;;AAFA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AAnBA,GAzCA;AA8DA,EAAA,KAAA,EAAA;AACA,IAAA,WADA,yBACA;AACA,WAAA,KAAA,GAAA,CAAA,CAAA,KAAA,CAAA,KAAA,WAAA,EAAA,UAAA,UAAA,EAAA;AACA,eAAA,UAAA,CAAA,UAAA,CAAA,MAAA,CAAA;AACA,OAFA,CAAA;AAGA;AALA;AA9DA,CAAA","sourcesContent":["<template>\n  <div>\n    <div v-if=\"restaurants.length\">\n      <ol>\n        <ol>\n          <li v-for=\"(restaurant, index) in restaurants\" :key=\"index\">\n            id: {{restaurant.id}}, {{ restaurant.name }} - {{ restaurant.cuisine }}\n            <button @click=\"removeRestaurant(restaurant)\">Remove</button>\n          </li>\n        </ol>\n      </ol>\n      <p>Total: {{ total }}</p>\n    </div>\n    <div v-else>\n      <p> You didn't go anywhere.</p>\n    </div>\n    <hr />\n    <p>New Restaurant:</p>\n    <form v-on:submit.prevent>\n      <div>\n        <input type=\"text\" v-model=\"name\" placeholder=\"Where did you go?\" />\n      </div>\n      <div>\n        <input type=\"text\" v-model=\"cuisine\" placeholder=\"How much is it?\" />\n      </div>\n      <div>\n        <button @click=\"addRestaurant()\">Submit</button>\n      </div>\n    </form>\n  </div>\n</template>\n \n<script>\nimport _ from \"lodash\";\n \nimport { collection, addDoc, doc, deleteDoc, onSnapshot } from \"firebase/firestore\";\n \nexport default {\n  name: \"HelloWorld\",\n  data: () => ({\n    name: \"\",\n    amount: \"\",\n    total: 0,\n    restaurants: [],\n  }),\n  created() {\n    onSnapshot(collection(this.$db, \"restaurants\"), (snapshot) => {\n      snapshot.docChanges().forEach((change) => {\n        console.dir(change.type);\n        console.dir(change.doc.id);\n        console.dir(change.doc.data());\n \n        let r = change.doc.data();\n        let id = change.doc.id;\n        let pos;\n \n        switch (change.type) {\n          case \"added\":\n            r.id = id;\n            this.restaurants.push(r);\n            break;\n          case \"modified\":\n            pos = this.restaurants.findIndex((element) => element.id === id);\n            console.log(\"POS = \" + pos + \" id=\" + id);\n            //console.dir(this.restaurants);\n            r.id = id;\n            this.$set(this.restaurants, pos, r);\n           // this.restaurants[pos] = r; // marche pas, la vue ne se met pas à jour, il faut $set !!\n            break;\n          case \"removed\":\n            console.log(\"removed\")\n            pos = this.restaurants.findIndex((element) => element.id === id);\n            this.restaurants.splice(pos, 1);\n            break;\n        }\n       });\n    });\n  },\n  methods: {\n    async addRestaurant() {\n      try {\n        const docRef = await addDoc(collection(this.$db, \"restaurants\"), {\n          name: this.name,\n          cuisine: this.cuisine,\n          dateCreated: new Date(),\n        });\n        this.cuisine = \"\";\n        this.name = \"\";\n \n        console.log(\"Document written with ID: \", docRef.id);\n      } catch (e) {\n        console.error(\"Error adding document: \", e);\n      }\n    },\n    async removeRestaurant(restaurant) {\n      await deleteDoc(doc(this.$db, \"restaurants\", restaurant.id));\n      console.log('je supprime doc id = ' + restaurant.id)\n    },\n  },\n  watch: {\n    restaurants() {\n      this.total = _.sumBy(this.restaurants, function (restaurant) {\n        return parseFloat(restaurant.amount);\n      });\n    },\n  },\n};\n</script>\n \n<style scoped>\ndiv {\n  margin-bottom: 20px;\n}\n</style>"],"sourceRoot":"../../TP 1/restaurants/src/components"}]}